<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Natty by Nature</title>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body, #root { min-height: 100%; }
    body { background: #FAF8F3; }
    input, textarea, select, button { font-family: inherit; }
    #error { display:none; padding:24px; color:#c0392b; font-family:sans-serif; font-size:14px; }
  </style>
</head>
<body>
  <div id="error"></div>
  <div id="root"></div>
  <script>
    window.onerror = function(msg, src, line, col, err) {
      document.getElementById('error').style.display = 'block';
      document.getElementById('error').innerText = 'Erreur: ' + msg + ' (ligne ' + line + ')';
      document.getElementById('root').style.display = 'none';
      return false;
    };
  </script>
  <script>
    (function() {
      'use strict';
      var useState = React.useState;
      var useEffect = React.useEffect;
      var useRef = React.useRef;

// ‚îÄ‚îÄ‚îÄ CONSTANTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const C = {
  deep: "#1E3D1A",
  mid: "#2D5A27",
  light: "#4A7C42",
  pale: "#C8E6C2",
  ultra: "#EBF5E8",
  gold: "#C9A96E",
  cream: "#FAF8F3",
  border: "#D5E8D0",
  text: "#1A1A1A",
  gray: "#666",
  psycho: "#7B3F00",
  psychoBg: "#FDF3E7",
  danger: "#c0392b"
};
const PRACTITIONERS = [{
  id: "maeva",
  name: "Maeva",
  role: "Coiffure & Diagnostic",
  pin: "1234",
  color: C.mid
}, {
  id: "maman",
  name: "Mich√®le",
  role: "Psychopraticienne",
  pin: "5678",
  color: C.psycho
}, {
  id: "admin",
  name: "Admin",
  role: "Acc√®s complet",
  pin: "0000",
  color: C.deep
}];
const FORFAITS = [{
  id: "consultation",
  label: "Consultation Natty",
  price: 90,
  suivi: false,
  sessions: [{
    type: "capillaire",
    label: "Consultation initiale",
    num: 1
  }]
}, {
  id: "decouverte",
  label: "Forfait D√©couverte",
  duration: "1 mois",
  price: 230,
  suivi: false,
  sessions: [{
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 2
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 1
  }]
}, {
  id: "immersion",
  label: "Forfait Immersion",
  duration: "3 mois",
  price: 590,
  suivi: false,
  sessions: [{
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 2
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 3
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 4
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 2
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 5
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 6
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 3
  }]
}, {
  id: "longterme",
  label: "Forfait Long Terme",
  duration: "6 mois",
  price: 890,
  suivi: false,
  sessions: Array.from({
    length: 12
  }, (_, i) => ({
    type: "libre",
    label: "S√©ance",
    num: i + 1
  }))
}, {
  id: "suivi_decouverte",
  label: "Forfait Suivi ‚Äî D√©couverte",
  duration: "1 mois",
  price: 190,
  suivi: true,
  sessions: [{
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 2
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 1
  }]
}, {
  id: "suivi_immersion",
  label: "Forfait Suivi ‚Äî Immersion",
  duration: "3 mois",
  price: 490,
  suivi: true,
  sessions: [{
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 2
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 1
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 3
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 4
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 2
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 5
  }, {
    type: "capillaire",
    label: "S√©ance Capillaire",
    num: 6
  }, {
    type: "psycho",
    label: "S√©ance Psycho",
    num: 3
  }]
}, {
  id: "suivi_longterme",
  label: "Forfait Suivi ‚Äî Long Terme",
  duration: "6 mois",
  price: 750,
  suivi: true,
  sessions: Array.from({
    length: 12
  }, (_, i) => ({
    type: "libre",
    label: "S√©ance",
    num: i + 1
  }))
}];
const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2);
const today = () => new Date().toISOString().slice(0, 10);
const fmt = d => d ? new Date(d + "T00:00:00").toLocaleDateString("fr-FR") : "‚Äî";

// ‚îÄ‚îÄ‚îÄ SUPABASE CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SUPABASE_URL = "https://rrmxlyrqrogktkwmbolu.supabase.co";
const SUPABASE_KEY = "sb_publishable_ILaH4dQ5IQPSfAtx-Lgaww_JvMrboPF";
const WORKSPACE = "natty_by_nature";

// ‚îÄ‚îÄ‚îÄ STORAGE ‚Äî Supabase REST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const store = {
  async get() {
    try {
      const res = await fetch(`${SUPABASE_URL}/rest/v1/natty_workspace?workspace_id=eq.${WORKSPACE}&select=data`, {
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`
        }
      });
      const rows = await res.json();
      return rows?.[0]?.data || null;
    } catch {
      return null;
    }
  },
  async set(clients) {
    try {
      await fetch(`${SUPABASE_URL}/rest/v1/natty_workspace`, {
        method: "POST",
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`,
          "Content-Type": "application/json",
          Prefer: "resolution=merge-duplicates"
        },
        body: JSON.stringify({
          workspace_id: WORKSPACE,
          data: clients,
          updated_at: new Date().toISOString()
        })
      });
      return true;
    } catch {
      return false;
    }
  }
};

// ‚îÄ‚îÄ‚îÄ SUPABASE SETUP SCREEN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// ‚îÄ‚îÄ‚îÄ GENERATE SESSIONS FROM FORFAIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function generateSessions(forfaitId, diagnostic) {
  const forfait = FORFAITS.find(f => f.id === forfaitId);
  if (!forfait) return [];
  return forfait.sessions.map((s, i) => ({
    id: uid(),
    type: s.type,
    label: s.label,
    num: s.num,
    date: "",
    done: false,
    // Pre-fill from diagnostic
    typeCheveu: diagnostic?.typeCheveu || "",
    axes: diagnostic?.axes ? {
      ...diagnostic.axes
    } : {
      hydra: 5,
      nutri: 5,
      fonda: 5
    },
    // To fill
    objectif: "",
    notes: "",
    progression: 5,
    nextSteps: "",
    psychoNotes: "",
    obstaclesTravailles: "",
    evolutionObservee: "",
    photo: null
  }));
}

// ‚îÄ‚îÄ‚îÄ STYLES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const s = {
  app: {
    fontFamily: "'Segoe UI', system-ui, sans-serif",
    background: C.cream,
    minHeight: "100vh",
    color: C.text
  },
  header: {
    background: C.deep,
    padding: "14px 16px",
    display: "flex",
    alignItems: "center",
    justifyContent: "space-between"
  },
  title: {
    fontFamily: "Georgia, serif",
    fontSize: 20,
    color: "white",
    fontWeight: 300
  },
  sub: {
    fontSize: 11,
    color: C.gold,
    letterSpacing: 2,
    textTransform: "uppercase"
  },
  nav: {
    background: C.mid,
    display: "flex",
    overflowX: "auto",
    borderBottom: `2px solid ${C.light}`
  },
  navBtn: a => ({
    padding: "11px 16px",
    fontSize: 12,
    fontWeight: 500,
    color: a ? "white" : "rgba(255,255,255,0.5)",
    cursor: "pointer",
    whiteSpace: "nowrap",
    background: "none",
    border: "none",
    borderBottom: a ? `2px solid ${C.gold}` : "2px solid transparent"
  }),
  card: (extra = {}) => ({
    background: "white",
    borderRadius: 12,
    border: `1.5px solid ${C.border}`,
    padding: "18px 20px",
    marginBottom: 14,
    ...extra
  }),
  label: {
    fontSize: 11,
    fontWeight: 600,
    letterSpacing: 1.5,
    textTransform: "uppercase",
    color: C.mid,
    display: "block",
    marginBottom: 5
  },
  input: {
    width: "100%",
    border: `1.5px solid ${C.border}`,
    borderRadius: 8,
    padding: "9px 13px",
    fontSize: 14,
    fontFamily: "inherit",
    color: C.text,
    background: "white",
    outline: "none",
    boxSizing: "border-box"
  },
  textarea: {
    width: "100%",
    border: `1.5px solid ${C.border}`,
    borderRadius: 8,
    padding: "9px 13px",
    fontSize: 14,
    fontFamily: "inherit",
    color: C.text,
    background: "white",
    outline: "none",
    resize: "vertical",
    minHeight: 75,
    boxSizing: "border-box"
  },
  select: {
    width: "100%",
    border: `1.5px solid ${C.border}`,
    borderRadius: 8,
    padding: "9px 13px",
    fontSize: 14,
    fontFamily: "inherit",
    background: "white",
    outline: "none",
    boxSizing: "border-box"
  },
  btn: (v = "primary", extra = {}) => ({
    padding: "9px 18px",
    borderRadius: 8,
    fontSize: 13,
    fontWeight: 500,
    cursor: "pointer",
    background: v === "primary" ? C.deep : v === "gold" ? C.gold : v === "danger" ? C.danger : v === "green" ? C.mid : v === "psycho" ? C.psycho : "white",
    color: v === "outline" ? C.mid : "white",
    border: v === "outline" ? `1.5px solid ${C.border}` : "none",
    ...extra
  }),
  grid2: {
    display: "grid",
    gridTemplateColumns: "1fr 1fr",
    gap: 14
  },
  pill: (a, col = C.mid) => ({
    padding: "6px 14px",
    borderRadius: 20,
    fontSize: 12,
    cursor: "pointer",
    border: `1.5px solid ${a ? col : C.border}`,
    background: a ? col : "white",
    color: a ? "white" : C.text,
    margin: "3px 3px 3px 0",
    display: "inline-block"
  }),
  sectionHead: {
    fontFamily: "Georgia, serif",
    fontSize: 18,
    color: C.deep,
    marginBottom: 14
  },
  badge: col => ({
    background: col,
    color: "white",
    fontSize: 11,
    padding: "3px 10px",
    borderRadius: 20
  })
};

// ‚îÄ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function Login({
  onLogin
}) {
  const [sel, setSel] = useState(null);
  const [pin, setPin] = useState("");
  const [err, setErr] = useState("");
  const attempt = () => {
    if (sel.pin === pin) onLogin(sel);else {
      setErr("Code incorrect");
      setPin("");
    }
  };
  return /*#__PURE__*/React.createElement("div", {
    style: {
      ...s.app,
      display: "flex",
      flexDirection: "column",
      alignItems: "center",
      justifyContent: "center",
      minHeight: "100vh",
      padding: 20
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      marginBottom: 36
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 10,
      letterSpacing: 4,
      color: C.gold,
      textTransform: "uppercase",
      marginBottom: 6
    }
  }, "Natty by Nature"), /*#__PURE__*/React.createElement("div", {
    style: {
      fontFamily: "Georgia, serif",
      fontSize: 28,
      color: C.deep,
      fontWeight: 300
    }
  }, "Quand le Cheveu Parle"), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 13,
      color: C.gray,
      marginTop: 6
    }
  }, "Espace Praticiens")), !sel ? /*#__PURE__*/React.createElement("div", {
    style: {
      width: "100%",
      maxWidth: 360
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 12,
      color: C.gray,
      textAlign: "center",
      marginBottom: 16
    }
  }, "Qui \xEAtes-vous ?"), PRACTITIONERS.map(p => /*#__PURE__*/React.createElement("div", {
    key: p.id,
    onClick: () => setSel(p),
    style: {
      ...s.card(),
      display: "flex",
      alignItems: "center",
      gap: 14,
      cursor: "pointer",
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      width: 42,
      height: 42,
      borderRadius: "50%",
      background: p.color,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      color: "white",
      fontWeight: 700,
      fontSize: 17
    }
  }, p.name[0]), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      fontWeight: 600
    }
  }, p.name), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 12,
      color: C.gray
    }
  }, p.role))))) : /*#__PURE__*/React.createElement("div", {
    style: {
      width: "100%",
      maxWidth: 300,
      textAlign: "center"
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 20,
      fontSize: 15,
      color: C.deep
    }
  }, "Code \u2014 ", /*#__PURE__*/React.createElement("strong", null, sel.name)), /*#__PURE__*/React.createElement("input", {
    type: "password",
    value: pin,
    onChange: e => setPin(e.target.value),
    onKeyDown: e => e.key === "Enter" && attempt(),
    placeholder: "\u2022\u2022\u2022\u2022",
    style: {
      ...s.input,
      textAlign: "center",
      fontSize: 22,
      letterSpacing: 8,
      marginBottom: 10
    }
  }), err && /*#__PURE__*/React.createElement("div", {
    style: {
      color: C.danger,
      fontSize: 12,
      marginBottom: 10
    }
  }, err), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 10,
      justifyContent: "center"
    }
  }, /*#__PURE__*/React.createElement("button", {
    style: s.btn("outline"),
    onClick: () => {
      setSel(null);
      setPin("");
      setErr("");
    }
  }, "Retour"), /*#__PURE__*/React.createElement("button", {
    style: s.btn(),
    onClick: attempt
  }, "Entrer"))));
}

// ‚îÄ‚îÄ‚îÄ GAUGE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function Gauge({
  label,
  emoji,
  value,
  onChange,
  readOnly
}) {
  return /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      justifyContent: "space-between",
      alignItems: "center",
      marginBottom: 6
    }
  }, /*#__PURE__*/React.createElement("span", {
    style: {
      fontSize: 14,
      fontWeight: 500
    }
  }, emoji, " ", label), /*#__PURE__*/React.createElement("span", {
    style: {
      fontFamily: "Georgia, serif",
      fontSize: 20,
      color: C.mid,
      fontWeight: 600
    }
  }, value, /*#__PURE__*/React.createElement("span", {
    style: {
      fontSize: 12,
      color: C.gray
    }
  }, "/10"))), /*#__PURE__*/React.createElement("div", {
    style: {
      height: 7,
      background: C.ultra,
      borderRadius: 4,
      overflow: "hidden",
      marginBottom: readOnly ? 0 : 6
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      height: "100%",
      width: `${value * 10}%`,
      background: `linear-gradient(90deg, ${C.light}, ${C.deep})`,
      borderRadius: 4,
      transition: "width 0.3s"
    }
  })), !readOnly && /*#__PURE__*/React.createElement("input", {
    type: "range",
    min: "1",
    max: "10",
    value: value,
    onChange: e => onChange(parseInt(e.target.value)),
    style: {
      width: "100%",
      accentColor: C.mid
    }
  }));
}

// ‚îÄ‚îÄ‚îÄ FIELD HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function Tags({
  opts,
  val,
  onChange,
  col
}) {
  return /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 4
    }
  }, opts.map(o => /*#__PURE__*/React.createElement("span", {
    key: o,
    onClick: () => onChange(o),
    style: s.pill(val === o, col || C.mid)
  }, o)));
}

// ‚îÄ‚îÄ‚îÄ DIAGNOSTIC TAB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function DiagnosticTab({
  client,
  onUpdate,
  readOnly
}) {
  const upd = (k, v) => onUpdate({
    ...client,
    [k]: v
  });
  const updAxe = (k, v) => onUpdate({
    ...client,
    axes: {
      ...client.axes,
      [k]: v
    }
  });
  const toggleAno = a => {
    const ano = client.anomalies || [];
    onUpdate({
      ...client,
      anomalies: ano.includes(a) ? ano.filter(x => x !== a) : [...ano, a]
    });
  };
  return /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\u2696\uFE0F Les 3 Axes"), /*#__PURE__*/React.createElement(Gauge, {
    label: "Hydratation",
    emoji: "\uD83D\uDCA7",
    value: client.axes?.hydra || 5,
    onChange: v => updAxe("hydra", v),
    readOnly: readOnly
  }), !readOnly && /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Observations Hydratation"), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 55
    },
    value: client.obsHydra || "",
    onChange: e => upd("obsHydra", e.target.value)
  })), /*#__PURE__*/React.createElement(Gauge, {
    label: "Nutrition",
    emoji: "\uD83C\uDF3F",
    value: client.axes?.nutri || 5,
    onChange: v => updAxe("nutri", v),
    readOnly: readOnly
  }), !readOnly && /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Observations Nutrition"), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 55
    },
    value: client.obsNutri || "",
    onChange: e => upd("obsNutri", e.target.value)
  })), /*#__PURE__*/React.createElement(Gauge, {
    label: "Fondation",
    emoji: "\uD83C\uDF31",
    value: client.axes?.fonda || 5,
    onChange: v => updAxe("fonda", v),
    readOnly: readOnly
  }), !readOnly && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Observations Fondation"), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 55
    },
    value: client.obsFonda || "",
    onChange: e => upd("obsFonda", e.target.value)
  }))), /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDD2C Observation du Cheveu"), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Type de cheveu"), /*#__PURE__*/React.createElement("div", null, ["1A", "1B", "1C", "2A", "2B", "2C", "3A", "3B", "3C", "4A", "4B", "4C"].map(t => /*#__PURE__*/React.createElement("span", {
    key: t,
    onClick: () => !readOnly && upd("typeCheveu", t),
    style: s.pill(client.typeCheveu === t)
  }, t)))), /*#__PURE__*/React.createElement("div", {
    style: s.grid2
  }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Porosit\xE9"), /*#__PURE__*/React.createElement(Tags, {
    opts: ["Faible", "Normale", "√âlev√©e"],
    val: client.porosite,
    onChange: v => !readOnly && upd("porosite", v)
  })), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Diam\xE8tre"), /*#__PURE__*/React.createElement(Tags, {
    opts: ["Fin", "Moyen", "√âpais", "Mixte"],
    val: client.diametre,
    onChange: v => !readOnly && upd("diametre", v)
  })), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Densit\xE9"), /*#__PURE__*/React.createElement(Tags, {
    opts: ["Faible", "Moyenne", "Dense"],
    val: client.densite,
    onChange: v => !readOnly && upd("densite", v)
  })), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Cuir chevelu"), /*#__PURE__*/React.createElement(Tags, {
    opts: ["Sain", "Sec", "Gras", "Sensible", "Pellicules", "Inflamm√©"],
    val: client.cuir,
    onChange: v => !readOnly && upd("cuir", v)
  }))), /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 8
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Anomalies"), /*#__PURE__*/React.createElement("div", null, ["Chute diffuse", "Zones d√©garnies", "Alop√©cie traction", "Pelade", "Cassure excessive", "Aucune"].map(a => /*#__PURE__*/React.createElement("span", {
    key: a,
    onClick: () => !readOnly && toggleAno(a),
    style: s.pill((client.anomalies || []).includes(a))
  }, a))))), /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83C\uDFAF Plan d'Action"), [["Priorit√© n¬∞1", "prio1"], ["Ingr√©dients recommand√©s", "ingredients"], ["Routine recommand√©e", "routine"], ["√Ä √©viter absolument", "aEviter"]].map(([l, k]) => /*#__PURE__*/React.createElement("div", {
    key: k,
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, l), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 55
    },
    value: client[k] || "",
    onChange: e => !readOnly && upd(k, e.target.value),
    readOnly: readOnly
  }))), /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Prochain RDV"), /*#__PURE__*/React.createElement("input", {
    style: s.input,
    value: client.rdv || "",
    onChange: e => !readOnly && upd("rdv", e.target.value),
    readOnly: readOnly
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      ...s.card(),
      borderLeft: `4px solid ${C.psycho}`
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      ...s.sectionHead,
      color: C.psycho
    }
  }, "\uD83E\uDDE0 Dimension Psycho-\xC9motionnelle"), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: {
      ...s.label,
      color: C.psycho
    }
  }, "Obstacles identifi\xE9s"), /*#__PURE__*/React.createElement("textarea", {
    style: s.textarea,
    value: client.psycho || "",
    onChange: e => !readOnly && upd("psycho", e.target.value),
    readOnly: readOnly
  })), /*#__PURE__*/React.createElement("label", {
    style: {
      ...s.label,
      color: C.psycho
    }
  }, "Suivi psychopraticien"), /*#__PURE__*/React.createElement(Tags, {
    opts: ["Prioritaire", "En compl√©ment", "√Ä r√©√©valuer", "Non n√©cessaire"],
    val: client.suiviPsycho,
    onChange: v => !readOnly && upd("suiviPsycho", v),
    col: C.psycho
  })));
}

// ‚îÄ‚îÄ‚îÄ SESSION CARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function SessionCard({
  session,
  index,
  diagnostic,
  practitioner,
  onUpdate
}) {
  const [open, setOpen] = useState(false);
  const photoRef = useRef();
  const canEdit = practitioner.id === "admin" || practitioner.id === "maeva" && session.type !== "psycho" || practitioner.id === "maman" && session.type === "psycho";
  const upd = (k, v) => onUpdate({
    ...session,
    [k]: v
  });
  const updAxe = (k, v) => onUpdate({
    ...session,
    axes: {
      ...session.axes,
      [k]: v
    }
  });
  const handlePhoto = e => {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 2 * 1024 * 1024) {
      alert("Photo trop lourde (max 2MB). Compresse l'image avant de l'ajouter.");
      return;
    }
    const reader = new FileReader();
    reader.onload = ev => upd("photo", ev.target.result);
    reader.readAsDataURL(file);
  };
  const typeColor = session.type === "psycho" ? C.psycho : session.type === "libre" ? C.light : C.mid;
  const typeLabel = session.type === "psycho" ? "S√©ance Psycho" : session.type === "libre" ? "S√©ance Libre" : "S√©ance Capillaire";
  return /*#__PURE__*/React.createElement("div", {
    style: {
      border: `1.5px solid ${session.done ? C.pale : C.border}`,
      borderRadius: 12,
      marginBottom: 10,
      background: session.done ? C.ultra : "white",
      overflow: "hidden"
    }
  }, /*#__PURE__*/React.createElement("div", {
    onClick: () => setOpen(!open),
    style: {
      padding: "14px 18px",
      cursor: "pointer",
      display: "flex",
      alignItems: "center",
      justifyContent: "space-between"
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      alignItems: "center",
      gap: 12
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      width: 36,
      height: 36,
      borderRadius: "50%",
      background: typeColor,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      color: "white",
      fontSize: 14,
      fontWeight: 700,
      flexShrink: 0
    }
  }, session.type === "psycho" ? "üß†" : session.type === "libre" ? "‚òÖ" : "‚úÇÔ∏è"), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      fontWeight: 600,
      fontSize: 15
    }
  }, session.label, " ", session.num && `n¬∞${session.num}`), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 12,
      color: C.gray
    }
  }, typeLabel, " ", session.date && `‚Ä¢ ${fmt(session.date)}`))), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      alignItems: "center",
      gap: 8
    }
  }, session.done && /*#__PURE__*/React.createElement("span", {
    style: {
      fontSize: 11,
      color: C.mid,
      fontWeight: 600
    }
  }, "\u2713 Faite"), session.photo && /*#__PURE__*/React.createElement("span", {
    style: {
      fontSize: 16
    }
  }, "\uD83D\uDCF7"), /*#__PURE__*/React.createElement("span", {
    style: {
      color: C.gray,
      fontSize: 18
    }
  }, open ? "‚Üë" : "‚Üì"))), open && /*#__PURE__*/React.createElement("div", {
    style: {
      padding: "0 18px 18px",
      borderTop: `1px solid ${C.border}`
    }
  }, diagnostic && /*#__PURE__*/React.createElement("div", {
    style: {
      background: C.ultra,
      borderRadius: 8,
      padding: "10px 14px",
      marginTop: 14,
      marginBottom: 14
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 11,
      letterSpacing: 1.5,
      textTransform: "uppercase",
      color: C.mid,
      marginBottom: 8
    }
  }, "\uD83D\uDCCB Rappel diagnostic initial"), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 12
    }
  }, [["üíß", "H", diagnostic.axes?.hydra], ["üåø", "N", diagnostic.axes?.nutri], ["üå±", "F", diagnostic.axes?.fonda]].map(([e, l, v]) => /*#__PURE__*/React.createElement("div", {
    key: l,
    style: {
      textAlign: "center"
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 11,
      color: C.gray
    }
  }, e, " ", l), /*#__PURE__*/React.createElement("div", {
    style: {
      fontFamily: "Georgia, serif",
      fontSize: 18,
      color: C.deep,
      fontWeight: 600
    }
  }, v || "‚Äî"))), diagnostic.typeCheveu && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 11,
      color: C.gray
    }
  }, "Type"), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 14,
      fontWeight: 600
    }
  }, diagnostic.typeCheveu)))), canEdit ? /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.grid2
  }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Date"), /*#__PURE__*/React.createElement("input", {
    type: "date",
    style: s.input,
    value: session.date,
    onChange: e => upd("date", e.target.value)
  })), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Progression \u2014 ", session.progression, "/10"), /*#__PURE__*/React.createElement("input", {
    type: "range",
    min: "1",
    max: "10",
    value: session.progression,
    onChange: e => upd("progression", parseInt(e.target.value)),
    style: {
      width: "100%",
      accentColor: typeColor,
      marginTop: 8
    }
  }))), session.type !== "psycho" && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 12,
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 12,
      fontWeight: 600,
      color: C.mid,
      marginBottom: 8
    }
  }, "\xC9volution des 3 axes"), /*#__PURE__*/React.createElement(Gauge, {
    label: "Hydratation",
    emoji: "\uD83D\uDCA7",
    value: session.axes?.hydra || 5,
    onChange: v => updAxe("hydra", v)
  }), /*#__PURE__*/React.createElement(Gauge, {
    label: "Nutrition",
    emoji: "\uD83C\uDF3F",
    value: session.axes?.nutri || 5,
    onChange: v => updAxe("nutri", v)
  }), /*#__PURE__*/React.createElement(Gauge, {
    label: "Fondation",
    emoji: "\uD83C\uDF31",
    value: session.axes?.fonda || 5,
    onChange: v => updAxe("fonda", v)
  }))), session.type === "psycho" ? /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: {
      ...s.label,
      color: C.psycho
    }
  }, "Obstacles travaill\xE9s"), /*#__PURE__*/React.createElement("textarea", {
    style: s.textarea,
    value: session.obstaclesTravailles || "",
    onChange: e => upd("obstaclesTravailles", e.target.value)
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: {
      ...s.label,
      color: C.psycho
    }
  }, "\xC9volution observ\xE9e"), /*#__PURE__*/React.createElement("textarea", {
    style: s.textarea,
    value: session.evolutionObservee || "",
    onChange: e => upd("evolutionObservee", e.target.value)
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: {
      ...s.label,
      color: C.psycho
    }
  }, "Notes de s\xE9ance"), /*#__PURE__*/React.createElement("textarea", {
    style: s.textarea,
    value: session.psychoNotes || "",
    onChange: e => upd("psychoNotes", e.target.value)
  }))) : /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Objectif de la s\xE9ance"), /*#__PURE__*/React.createElement("input", {
    style: s.input,
    value: session.objectif || "",
    onChange: e => upd("objectif", e.target.value)
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Notes & observations"), /*#__PURE__*/React.createElement("textarea", {
    style: s.textarea,
    value: session.notes || "",
    onChange: e => upd("notes", e.target.value)
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Prochaines \xE9tapes"), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 55
    },
    value: session.nextSteps || "",
    onChange: e => upd("nextSteps", e.target.value)
  }))), session.type !== "psycho" && /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "\uD83D\uDCF7 Photo de suivi"), /*#__PURE__*/React.createElement("div", {
    onClick: () => photoRef.current.click(),
    style: {
      height: 120,
      border: `2px dashed ${C.border}`,
      borderRadius: 10,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      cursor: "pointer",
      overflow: "hidden",
      background: C.ultra
    }
  }, session.photo ? /*#__PURE__*/React.createElement("img", {
    src: session.photo,
    alt: "suivi",
    style: {
      width: "100%",
      height: "100%",
      objectFit: "cover"
    }
  }) : /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      color: C.gray,
      fontSize: 13
    }
  }, "\uD83D\uDCF7", /*#__PURE__*/React.createElement("br", null), "Photo de s\xE9ance")), /*#__PURE__*/React.createElement("input", {
    ref: photoRef,
    type: "file",
    accept: "image/*",
    style: {
      display: "none"
    },
    onChange: handlePhoto
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 10,
      marginTop: 14
    }
  }, /*#__PURE__*/React.createElement("button", {
    style: s.btn(session.done ? "outline" : "green"),
    onClick: () => upd("done", !session.done)
  }, session.done ? "‚úì Faite ‚Äî Rouvrir" : "‚úì Marquer comme faite"))) : /*#__PURE__*/React.createElement("div", {
    style: {
      padding: "10px 0",
      color: C.gray,
      fontSize: 13,
      fontStyle: "italic"
    }
  }, "Cette s\xE9ance est g\xE9r\xE9e par ", session.type === "psycho" ? "Mich√®le" : "Maeva", ".", session.done && /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 8,
      color: C.mid,
      fontWeight: 500
    }
  }, "\u2713 S\xE9ance effectu\xE9e le ", fmt(session.date)))));
}

// ‚îÄ‚îÄ‚îÄ PHOTOS TAB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function PhotosTab({
  client,
  onUpdate
}) {
  const beforeRef = useRef();
  const afterRef = useRef();
  const refsMap = {
    before: beforeRef,
    after: afterRef
  };
  const handlePhoto = (type, e) => {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 2 * 1024 * 1024) {
      alert("Photo trop lourde (max 2MB). Compresse l'image avant de l'ajouter.");
      return;
    }
    const reader = new FileReader();
    reader.onload = ev => onUpdate({
      ...client,
      photos: {
        ...(client.photos || {}),
        [type]: ev.target.result
      }
    });
    reader.readAsDataURL(file);
  };

  // Interval photos from sessions
  const intervalPhotos = (client.sessions || []).filter(s => s.photo && s.date).sort((a, b) => a.date.localeCompare(b.date));
  return /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDCF8 Photos Cl\xE9s"), /*#__PURE__*/React.createElement("div", {
    style: s.grid2
  }, ["before", "after"].map(type => /*#__PURE__*/React.createElement("div", {
    key: type
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, type === "before" ? "üì∑ Avant" : "‚ú® Apr√®s"), /*#__PURE__*/React.createElement("div", {
    onClick: () => refsMap[type].current.click(),
    style: {
      height: 180,
      borderRadius: 10,
      overflow: "hidden",
      background: C.ultra,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      cursor: "pointer",
      border: `1.5px dashed ${C.border}`
    }
  }, client.photos?.[type] ? /*#__PURE__*/React.createElement("img", {
    src: client.photos[type],
    alt: type,
    style: {
      width: "100%",
      height: "100%",
      objectFit: "cover"
    }
  }) : /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      color: C.gray,
      fontSize: 13
    }
  }, "Appuyer pour ajouter")), /*#__PURE__*/React.createElement("input", {
    ref: refsMap[type],
    type: "file",
    accept: "image/*",
    style: {
      display: "none"
    },
    onChange: e => handlePhoto(type, e)
  }))))), intervalPhotos.length > 0 && /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDCC5 Photos d'\xE9volution"), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "grid",
      gridTemplateColumns: "repeat(auto-fill, minmax(130px, 1fr))",
      gap: 12
    }
  }, intervalPhotos.map((sess, i) => /*#__PURE__*/React.createElement("div", {
    key: sess.id
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      height: 130,
      borderRadius: 10,
      overflow: "hidden",
      background: C.ultra
    }
  }, /*#__PURE__*/React.createElement("img", {
    src: sess.photo,
    alt: `s√©ance ${i + 1}`,
    style: {
      width: "100%",
      height: "100%",
      objectFit: "cover"
    }
  })), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 11,
      color: C.gray,
      textAlign: "center",
      marginTop: 4
    }
  }, sess.label, " ", sess.num, " \u2022 ", fmt(sess.date)))))), intervalPhotos.length === 0 && /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      color: C.gray,
      padding: 30,
      fontStyle: "italic",
      fontSize: 13
    }
  }, "Les photos prises lors des s\xE9ances appara\xEEtront ici automatiquement"));
}

// ‚îÄ‚îÄ‚îÄ PDF GENERATOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function generatePdfHtml(client, type) {
  const forfait = FORFAITS.find(f => f.id === client.forfait);
  const doneSessions = (client.sessions || []).filter(s => s.done);
  const axes = client.axes || {
    hydra: 5,
    nutri: 5,
    fonda: 5
  };
  const axeBar = val => `
    <div style="height:8px;background:#EBF5E8;border-radius:4px;overflow:hidden;margin-top:6px">
      <div style="height:100%;width:${val * 10}%;background:linear-gradient(90deg,#4A7C42,#1E3D1A);border-radius:4px"></div>
    </div>`;
  const sessionRows = doneSessions.map(s => `
    <div style="background:#EBF5E8;border-radius:8px;padding:12px 16px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;margin-bottom:4px">
        <span style="font-weight:600;font-size:14px">${s.label} ${s.num || ""}</span>
        <span style="font-size:13px;color:#2D5A27">${s.progression}/10 ${s.date ? "‚Ä¢ " + fmt(s.date) : ""}</span>
      </div>
      ${s.notes ? `<div style="font-size:13px;color:#666;margin-top:4px">${s.notes}</div>` : ""}
      ${s.evolutionObservee ? `<div style="font-size:13px;color:#7B3F00;margin-top:4px">${s.evolutionObservee}</div>` : ""}
      ${s.nextSteps ? `<div style="font-size:13px;color:#2D5A27;margin-top:4px">‚Üí ${s.nextSteps}</div>` : ""}
    </div>`).join("");
  const planItems = [["Priorit√© n¬∞1", client.prio1], ["Ingr√©dients recommand√©s", client.ingredients], ["Routine recommand√©e", client.routine], ["√Ä √©viter absolument", client.aEviter], ["Prochain RDV", client.rdv]].filter(([, v]) => v).map(([l, v]) => `
    <div style="margin-bottom:12px">
      <div style="font-size:11px;text-transform:uppercase;letter-spacing:1px;color:#2D5A27;margin-bottom:3px">${l}</div>
      <div style="font-size:14px;color:#1A1A1A">${v}</div>
    </div>`).join("");
  const photoBefore = client.photos?.before ? `<div style="margin-bottom:24px"><div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:10px">üì∑ Photo Avant</div><img src="${client.photos.before}" style="width:100%;max-height:260px;object-fit:cover;border-radius:10px"/></div>` : "";
  const photoAfter = client.photos?.after ? `<div style="margin-bottom:24px"><div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:10px">‚ú® Photo Apr√®s</div><img src="${client.photos.after}" style="width:100%;max-height:260px;object-fit:cover;border-radius:10px"/></div>` : "";
  const intervalPhotos = (client.sessions || []).filter(s => s.photo && s.date).sort((a, b) => a.date.localeCompare(b.date));
  const photoGrid = intervalPhotos.length > 0 ? `
    <div style="margin-bottom:24px">
      <div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:12px">üìÖ √âvolution photographique</div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px">
        ${intervalPhotos.map(s => `
          <div>
            <img src="${s.photo}" style="width:100%;height:120px;object-fit:cover;border-radius:8px"/>
            <div style="font-size:11px;color:#666;text-align:center;margin-top:4px">${s.label} ${s.num || ""} ‚Ä¢ ${fmt(s.date)}</div>
          </div>`).join("")}
      </div>
    </div>` : "";
  return `<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>${type === "diagnostic" ? "Diagnostic" : "Bilan"} ‚Äî ${client.prenom} ${client.nom}</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: Georgia, serif; background: white; color: #1A1A1A; padding: 32px; max-width: 720px; margin: 0 auto; }
    @media print {
      body { padding: 16px; }
      .no-print { display: none !important; }
      @page { margin: 1.5cm; }
    }
  </style>
</head>
<body>
  <!-- PRINT BUTTON -->
  <div class="no-print" style="text-align:center;margin-bottom:24px">
    <button onclick="window.print()" style="background:#C9A96E;color:white;border:none;padding:12px 32px;border-radius:8px;font-size:15px;cursor:pointer;font-family:Georgia,serif">
      üñ®Ô∏è Imprimer / Sauvegarder PDF
    </button>
    <div style="font-size:12px;color:#666;margin-top:8px">Sur t√©l√©phone : appuyer sur Imprimer puis "Enregistrer en PDF"</div>
  </div>

  <!-- HEADER -->
  <div style="background:#1E3D1A;padding:24px 28px;border-radius:12px;margin-bottom:24px;color:white">
    <div style="font-size:10px;letter-spacing:3px;text-transform:uppercase;color:#C9A96E;margin-bottom:6px">Natty by Nature ‚Äî Quand le Cheveu Parle</div>
    <div style="font-size:24px;font-weight:300;margin-bottom:4px">${type === "diagnostic" ? "R√©capitulatif Diagnostic" : "Bilan Final de Suivi"}</div>
    <div style="font-size:14px;color:rgba(255,255,255,0.7)">${client.prenom || ""} ${client.nom || ""} ${client.dateDebut ? "‚Ä¢ " + fmt(client.dateDebut) : ""} ${forfait ? "‚Ä¢ " + forfait.label : ""}</div>
  </div>

  <!-- 3 AXES -->
  <div style="margin-bottom:24px">
    <div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:14px">Les 3 Axes ‚Äî Diagnostic Initial</div>
    <div style="display:flex;gap:14px">
      ${[["üíß", "Hydratation", axes.hydra], ["üåø", "Nutrition", axes.nutri], ["üå±", "Fondation", axes.fonda]].map(([e, l, v]) => `
        <div style="flex:1;background:#EBF5E8;border-radius:10px;padding:16px;text-align:center">
          <div style="font-size:12px;color:#2D5A27;margin-bottom:4px">${e} ${l}</div>
          <div style="font-size:36px;color:#1E3D1A;font-weight:700">${v}</div>
          <div style="font-size:11px;color:#666">/10</div>
          ${axeBar(v)}
        </div>`).join("")}
    </div>
  </div>

  <!-- TYPE DE CHEVEU & PROFIL -->
  ${client.typeCheveu || client.porosite || client.densite ? `
  <div style="margin-bottom:24px;background:#EBF5E8;border-radius:10px;padding:16px">
    <div style="font-size:14px;font-weight:600;color:#1E3D1A;margin-bottom:8px">Profil Capillaire</div>
    <div style="display:flex;gap:24px;flex-wrap:wrap">
      ${client.typeCheveu ? `<div><div style="font-size:11px;color:#666">Type</div><div style="font-size:15px;font-weight:600">${client.typeCheveu}</div></div>` : ""}
      ${client.porosite ? `<div><div style="font-size:11px;color:#666">Porosit√©</div><div style="font-size:15px;font-weight:600">${client.porosite}</div></div>` : ""}
      ${client.diametre ? `<div><div style="font-size:11px;color:#666">Diam√®tre</div><div style="font-size:15px;font-weight:600">${client.diametre}</div></div>` : ""}
      ${client.densite ? `<div><div style="font-size:11px;color:#666">Densit√©</div><div style="font-size:15px;font-weight:600">${client.densite}</div></div>` : ""}
      ${client.cuir ? `<div><div style="font-size:11px;color:#666">Cuir chevelu</div><div style="font-size:15px;font-weight:600">${client.cuir}</div></div>` : ""}
    </div>
  </div>` : ""}

  <!-- PHOTO AVANT -->
  ${photoBefore}

  ${type === "bilan" ? `
  <!-- S√âANCES -->
  ${doneSessions.length > 0 ? `
  <div style="margin-bottom:24px">
    <div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:10px">Progression du Suivi ‚Äî ${doneSessions.length} s√©ance(s) effectu√©e(s)</div>
    ${sessionRows}
  </div>` : ""}

  <!-- PHOTO APR√àS -->
  ${photoAfter}

  <!-- PHOTOS √âVOLUTION -->
  ${photoGrid}
  ` : ""}

  <!-- PLAN D'ACTION -->
  ${planItems ? `
  <div style="margin-bottom:24px">
    <div style="font-size:16px;font-weight:600;color:#1E3D1A;margin-bottom:12px">Plan d'Action</div>
    ${planItems}
  </div>` : ""}

  <!-- FOOTER -->
  <div style="border-top:1px solid #D5E8D0;padding-top:14px;font-size:11px;color:#666;text-align:center">
    Natty by Nature ‚Äî Quand le Cheveu Parle üåø ‚Ä¢ Document confidentiel et personnel
  </div>
</body>
</html>`;
}
function openPdf(client, type) {
  const html = generatePdfHtml(client, type);
  const filename = `${type === "diagnostic" ? "diagnostic" : "bilan"}_${(client.prenom || "cliente").toLowerCase()}_${(client.nom || "").toLowerCase()}.html`;
  const a = document.createElement("a");
  a.href = "data:text/html;charset=utf-8," + encodeURIComponent(html);
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// ‚îÄ‚îÄ‚îÄ CLIENT DETAIL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function ClientDetail({
  client,
  practitioner,
  onUpdate,
  onBack
}) {
  const [tab, setTab] = useState("info");
  const [editDiag, setEditDiag] = useState(false);
  const [confirmDelete, setConfirmDelete] = useState(false);
  const [confirmForfait, setConfirmForfait] = useState(null); // stores new forfait id pending confirmation

  const forfait = FORFAITS.find(f => f.id === client.forfait);
  const sessions = client.sessions || [];
  const done = sessions.filter(s => s.done).length;
  const progress = forfait ? Math.round(done / sessions.length * 100) : 0;
  const updateSession = async (idx, updated) => {
    const newSessions = sessions.map((s, i) => i === idx ? updated : s);
    const updatedClient = {
      ...client,
      sessions: newSessions
    };
    onUpdate(updatedClient);
  };
  const tabs = [{
    id: "info",
    label: "üë§ Profil"
  }, {
    id: "anamn",
    label: "üï∞Ô∏è Anamn√®se"
  }, {
    id: "diag",
    label: "‚öñÔ∏è Diagnostic"
  }, {
    id: "seances",
    label: `üìÖ S√©ances (${done}/${sessions.length})`
  }, {
    id: "photos",
    label: "üì∏ Photos"
  }];
  const upd = (k, v) => onUpdate({
    ...client,
    [k]: v
  });
  const tags = (opts, field, col) => /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 4
    }
  }, opts.map(o => /*#__PURE__*/React.createElement("span", {
    key: o,
    onClick: () => upd(field, o),
    style: s.pill(client[field] === o, col || C.mid)
  }, o)));
  return /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      background: C.deep,
      padding: "14px 16px"
    }
  }, /*#__PURE__*/React.createElement("button", {
    onClick: onBack,
    style: {
      background: "none",
      border: "none",
      color: C.gold,
      cursor: "pointer",
      fontSize: 13,
      marginBottom: 8
    }
  }, "\u2190 Clientes"), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      alignItems: "center",
      gap: 14,
      marginBottom: forfait ? 12 : 0
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      width: 46,
      height: 46,
      borderRadius: "50%",
      background: C.mid,
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      color: "white",
      fontSize: 20,
      fontWeight: 700
    }
  }, (client.prenom || "?")[0]), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      color: "white",
      fontFamily: "Georgia, serif",
      fontSize: 20
    }
  }, client.prenom, " ", client.nom), /*#__PURE__*/React.createElement("div", {
    style: {
      color: C.gold,
      fontSize: 12
    }
  }, forfait?.label || "Aucun forfait", " ", client.localisation && `‚Ä¢ ${client.localisation}`))), forfait && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      justifyContent: "space-between",
      fontSize: 11,
      color: "rgba(255,255,255,0.5)",
      marginBottom: 4
    }
  }, /*#__PURE__*/React.createElement("span", null, done, "/", sessions.length, " s\xE9ances"), /*#__PURE__*/React.createElement("span", null, progress, "%")), /*#__PURE__*/React.createElement("div", {
    style: {
      height: 5,
      background: "rgba(255,255,255,0.15)",
      borderRadius: 3,
      overflow: "hidden"
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      height: "100%",
      width: `${progress}%`,
      background: C.gold,
      transition: "width 0.3s"
    }
  }))), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 8,
      marginTop: 10
    }
  }, /*#__PURE__*/React.createElement("button", {
    style: s.btn("outline", {
      color: C.gold,
      borderColor: "rgba(255,255,255,0.2)",
      fontSize: 12,
      padding: "6px 12px"
    }),
    onClick: () => openPdf(client, "diagnostic")
  }, "\u2B07\uFE0F T\xE9l\xE9charger Diagnostic"), sessions.length > 0 && /*#__PURE__*/React.createElement("button", {
    style: s.btn("outline", {
      color: C.gold,
      borderColor: "rgba(255,255,255,0.2)",
      fontSize: 12,
      padding: "6px 12px"
    }),
    onClick: () => openPdf(client, "bilan")
  }, "\u2B07\uFE0F T\xE9l\xE9charger Bilan"))), /*#__PURE__*/React.createElement("div", {
    style: s.nav
  }, tabs.map(t => /*#__PURE__*/React.createElement("button", {
    key: t.id,
    style: s.navBtn(tab === t.id),
    onClick: () => setTab(t.id)
  }, t.label))), /*#__PURE__*/React.createElement("div", {
    style: {
      padding: "16px 16px 80px"
    }
  }, tab === "info" && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDC64 Informations G\xE9n\xE9rales"), /*#__PURE__*/React.createElement("div", {
    style: s.grid2
  }, [["Pr√©nom", "prenom"], ["Nom", "nom"], ["√Çge", "age"], ["Email", "email"], ["WhatsApp", "tel"], ["Origine", "origine"], ["Localisation", "localisation"]].map(([l, k]) => /*#__PURE__*/React.createElement("div", {
    key: k
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, l), /*#__PURE__*/React.createElement("input", {
    style: s.input,
    value: client[k] || "",
    onChange: e => upd(k, e.target.value)
  })))), /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Forfait"), confirmForfait && /*#__PURE__*/React.createElement("div", {
    style: {
      background: "#fff3cd",
      border: "1.5px solid #ffc107",
      borderRadius: 8,
      padding: "12px 14px",
      marginBottom: 10
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 13,
      marginBottom: 8
    }
  }, "\u26A0\uFE0F Changer de forfait va effacer les s\xE9ances existantes. Confirmer ?"), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 8
    }
  }, /*#__PURE__*/React.createElement("button", {
    style: s.btn("outline"),
    onClick: () => setConfirmForfait(null)
  }, "Annuler"), /*#__PURE__*/React.createElement("button", {
    style: s.btn("danger"),
    onClick: () => {
      onUpdate({
        ...client,
        forfait: confirmForfait,
        sessions: generateSessions(confirmForfait, client)
      });
      setConfirmForfait(null);
    }
  }, "Confirmer"))), /*#__PURE__*/React.createElement("select", {
    style: s.select,
    value: client.forfait || "",
    onChange: e => {
      const newF = e.target.value;
      if (!newF) return;
      const hasSessions = (client.sessions || []).some(s => s.done || s.notes || s.date);
      if (hasSessions && newF !== client.forfait) {
        setConfirmForfait(newF);
      } else {
        onUpdate({
          ...client,
          forfait: newF,
          sessions: generateSessions(newF, client)
        });
      }
    }
  }, /*#__PURE__*/React.createElement("option", {
    value: ""
  }, "S\xE9lectionner..."), /*#__PURE__*/React.createElement("optgroup", {
    label: "Forfaits standards"
  }, FORFAITS.filter(f => !f.suivi).map(f => /*#__PURE__*/React.createElement("option", {
    key: f.id,
    value: f.id
  }, f.label, " \u2014 ", f.price, "\u20AC"))), /*#__PURE__*/React.createElement("optgroup", {
    label: "Forfaits suivi"
  }, FORFAITS.filter(f => f.suivi).map(f => /*#__PURE__*/React.createElement("option", {
    key: f.id,
    value: f.id
  }, f.label, " \u2014 ", f.price, "\u20AC")))), forfait && /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 8,
      fontSize: 12,
      color: C.mid,
      fontStyle: "italic"
    }
  }, "\u2192 ", sessions.length, " s\xE9ances g\xE9n\xE9r\xE9es automatiquement")), /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Date de d\xE9but"), /*#__PURE__*/React.createElement("input", {
    type: "date",
    style: s.input,
    value: client.dateDebut || today(),
    onChange: e => upd("dateDebut", e.target.value)
  }))), /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDCAC Demande & Vision"), [["Pourquoi elle vient", "demande"], ["Sa vision de sa chevelure", "vision"], ["Ce qu'elle veut garder", "garder"]].map(([l, k]) => /*#__PURE__*/React.createElement("div", {
    key: k,
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, l), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 60
    },
    value: client[k] || "",
    onChange: e => upd(k, e.target.value)
  }))))), tab === "anamn" && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\uD83D\uDD70\uFE0F Parcours & Ant\xE9c\xE9dents"), [["Parcours capillaire", "parcours"], ["Colorations / √âclaircissements (5 ans)", "colorations"], ["Poudres & traitements naturels", "poudres"], ["Quand elle dit 'j'ai tout essay√©'", "toutEssaye"]].map(([l, k]) => /*#__PURE__*/React.createElement("div", {
    key: k,
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, l), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 60
    },
    value: client[k] || "",
    onChange: e => upd(k, e.target.value)
  })))), /*#__PURE__*/React.createElement("div", {
    style: s.card()
  }, /*#__PURE__*/React.createElement("div", {
    style: s.sectionHead
  }, "\u2695\uFE0F Sant\xE9 & Mode de Vie"), /*#__PURE__*/React.createElement("div", {
    style: {
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Probl\xE8mes de sant\xE9"), /*#__PURE__*/React.createElement("textarea", {
    style: {
      ...s.textarea,
      minHeight: 60
    },
    value: client.sante || "",
    onChange: e => upd("sante", e.target.value)
  })), /*#__PURE__*/React.createElement("div", {
    style: s.grid2
  }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Stress"), tags(["Faible", "Mod√©r√©", "√âlev√©", "Tr√®s √©lev√©"], "stress")), /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Eau utilis\xE9e"), tags(["Robinet", "Filtr√©e", "Calcaire", "Source"], "eau"))), /*#__PURE__*/React.createElement("div", {
    style: {
      marginTop: 12
    }
  }, /*#__PURE__*/React.createElement("label", {
    style: s.label
  }, "Environnement g\xE9ographique"), /*#__PURE__*/React.createElement("input", {
    style: s.input,
    value: client.environnement || "",
    onChange: e => upd("environnement", e.target.value)
  })))), tab === "diag" && /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      justifyContent: "flex-end",
      marginBottom: 12
    }
  }, /*#__PURE__*/React.createElement("button", {
    style: s.btn(editDiag ? "outline" : "primary"),
    onClick: () => setEditDiag(!editDiag)
  }, editDiag ? "‚úì Terminer" : "‚úèÔ∏è Modifier")), /*#__PURE__*/React.createElement(DiagnosticTab, {
    client: client,
    onUpdate: onUpdate,
    readOnly: !editDiag
  })), tab === "seances" && /*#__PURE__*/React.createElement("div", null, sessions.length === 0 ? /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      color: C.gray,
      padding: 40,
      fontStyle: "italic"
    }
  }, "S\xE9lectionne un forfait pour g\xE9n\xE9rer les s\xE9ances automatiquement") : sessions.map((sess, idx) => /*#__PURE__*/React.createElement(SessionCard, {
    key: sess.id,
    session: sess,
    index: idx,
    diagnostic: client,
    practitioner: practitioner,
    onUpdate: updated => updateSession(idx, updated)
  }))), tab === "photos" && /*#__PURE__*/React.createElement(PhotosTab, {
    client: client,
    onUpdate: onUpdate
  })));
}

// ‚îÄ‚îÄ‚îÄ MAIN APP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function App() {
  const [practitioner, setPractitioner] = useState(null);
  const [clients, setClients] = useState([]);
  const [view, setView] = useState("list");
  const [selected, setSelected] = useState(null);
  const [search, setSearch] = useState("");
  const [saving, setSaving] = useState(false);
  const [saved, setSaved] = useState(false);
  const [confirmDelete, setConfirmDelete] = useState(false);
  const saveTimer = useRef(null);
  useEffect(() => {
    if (!practitioner) return;
    store.get().then(data => {
      if (data) setClients(data);
    });
  }, [practitioner]);

  // Mise √† jour locale instantan√©e ‚Äî sauvegarde Supabase apr√®s 1.5s d'inactivit√©
  const persist = updated => {
    setClients(updated);
    setSaved(false);
    if (saveTimer.current) clearTimeout(saveTimer.current);
    saveTimer.current = setTimeout(async () => {
      setSaving(true);
      await store.set(updated);
      setSaving(false);
      setSaved(true);
      setTimeout(() => setSaved(false), 2000);
    }, 1500);
  };
  const saveClient = client => {
    const idx = clients.findIndex(c => c.id === client.id);
    const updated = idx >= 0 ? clients.map((c, i) => i === idx ? client : c) : [...clients, client];
    persist(updated);
    setSelected(client);
    setView("detail");
  };
  const updateClient = client => {
    const updated = clients.map(c => c.id === client.id ? client : c);
    persist(updated);
    setSelected(client);
  };
  const deleteClient = async id => {
    if (saveTimer.current) clearTimeout(saveTimer.current);
    const updated = clients.filter(c => c.id !== id);
    setClients(updated);
    await store.set(updated);
    setView("list");
  };
  const newClient = () => {
    const blank = {
      id: uid(),
      prenom: "",
      nom: "",
      age: "",
      email: "",
      tel: "",
      origine: "",
      localisation: "",
      forfait: "",
      dateDebut: today(),
      sessions: [],
      photos: {},
      axes: {
        hydra: 5,
        nutri: 5,
        fonda: 5
      },
      anomalies: []
    };
    setSelected(blank);
    setView("detail");
  };
  const visible = clients.filter(c => {
    if (search && !`${c.prenom} ${c.nom}`.toLowerCase().includes(search.toLowerCase())) return false;
    if (practitioner?.id === "maman") return (c.sessions || []).some(s => s.type === "psycho") || ["Prioritaire", "En compl√©ment"].includes(c.suiviPsycho);
    return true;
  });
  if (!practitioner) return /*#__PURE__*/React.createElement(Login, {
    onLogin: setPractitioner
  });
  if (view === "detail" && selected) {
    return /*#__PURE__*/React.createElement("div", {
      style: s.app
    }, /*#__PURE__*/React.createElement("div", {
      style: s.header
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
      style: s.title
    }, "Natty by Nature \uD83C\uDF3F")), /*#__PURE__*/React.createElement("div", {
      style: {
        display: "flex",
        alignItems: "center",
        gap: 10
      }
    }, saved && /*#__PURE__*/React.createElement("span", {
      style: {
        fontSize: 11,
        color: C.gold
      }
    }, "\u2713 Sauvegard\xE9"), saving && /*#__PURE__*/React.createElement("span", {
      style: {
        fontSize: 11,
        color: "rgba(255,255,255,0.4)"
      }
    }, "\u27F3"), /*#__PURE__*/React.createElement("button", {
      onClick: () => setView("list"),
      style: {
        background: "none",
        border: "none",
        color: "rgba(255,255,255,0.5)",
        cursor: "pointer",
        fontSize: 12
      }
    }, "\u2190 Liste"))), /*#__PURE__*/React.createElement(ClientDetail, {
      client: selected,
      practitioner: practitioner,
      onUpdate: client => {
        setSelected(client);
        saveClient(client);
      },
      onBack: () => setView("list")
    }), (practitioner.id === "maeva" || practitioner.id === "admin") && selected.id && clients.find(c => c.id === selected.id) && /*#__PURE__*/React.createElement("div", {
      style: {
        padding: "0 16px 20px",
        textAlign: "right"
      }
    }, confirmDelete ? /*#__PURE__*/React.createElement("div", {
      style: {
        display: "flex",
        gap: 10,
        justifyContent: "flex-end",
        alignItems: "center"
      }
    }, /*#__PURE__*/React.createElement("span", {
      style: {
        fontSize: 13,
        color: C.danger
      }
    }, "Supprimer d\xE9finitivement ?"), /*#__PURE__*/React.createElement("button", {
      style: s.btn("outline"),
      onClick: () => setConfirmDelete(false)
    }, "Annuler"), /*#__PURE__*/React.createElement("button", {
      style: s.btn("danger"),
      onClick: () => deleteClient(selected.id)
    }, "Confirmer")) : /*#__PURE__*/React.createElement("button", {
      style: s.btn("danger"),
      onClick: () => setConfirmDelete(true)
    }, "\uD83D\uDDD1 Supprimer")));
  }

  // LIST VIEW
  const totalSessions = clients.reduce((a, c) => a + (c.sessions?.filter(s => s.done)?.length || 0), 0);
  const totalCA = clients.reduce((a, c) => {
    const f = FORFAITS.find(fo => fo.id === c.forfait);
    return a + (f?.price || 0);
  }, 0);
  return /*#__PURE__*/React.createElement("div", {
    style: s.app
  }, /*#__PURE__*/React.createElement("div", {
    style: s.header
  }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
    style: s.title
  }, "Natty by Nature \uD83C\uDF3F"), /*#__PURE__*/React.createElement("div", {
    style: s.sub
  }, "Quand le Cheveu Parle")), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      alignItems: "center",
      gap: 10
    }
  }, saved && /*#__PURE__*/React.createElement("span", {
    style: {
      fontSize: 11,
      color: C.gold
    }
  }, "\u2713"), /*#__PURE__*/React.createElement("span", {
    style: s.badge(PRACTITIONERS.find(p => p.id === practitioner.id)?.color || C.mid)
  }, practitioner.name), /*#__PURE__*/React.createElement("button", {
    onClick: () => setPractitioner(null),
    style: {
      background: "none",
      border: "none",
      color: "rgba(255,255,255,0.4)",
      cursor: "pointer",
      fontSize: 12
    }
  }, "Quitter"))), /*#__PURE__*/React.createElement("div", {
    style: {
      padding: "16px 16px 0"
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 10,
      marginBottom: 16
    }
  }, [["üë•", visible.length, "Clientes"], ["üìÖ", totalSessions, "S√©ances"], ["üí∂", `${totalCA}‚Ç¨`, "CA total"]].map(([e, v, l]) => /*#__PURE__*/React.createElement("div", {
    key: l,
    style: {
      flex: 1,
      ...s.card({
        marginBottom: 0,
        textAlign: "center",
        padding: "12px 8px"
      })
    }
  }, /*#__PURE__*/React.createElement("div", {
    style: {
      fontFamily: "Georgia, serif",
      fontSize: 20,
      color: C.deep
    }
  }, e, " ", v), /*#__PURE__*/React.createElement("div", {
    style: {
      fontSize: 11,
      color: C.gray
    }
  }, l)))), /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      gap: 10,
      marginBottom: 16
    }
  }, /*#__PURE__*/React.createElement("input", {
    style: {
      ...s.input,
      flex: 1
    },
    placeholder: "\uD83D\uDD0D Rechercher...",
    value: search,
    onChange: e => setSearch(e.target.value)
  }), practitioner.id !== "maman" && /*#__PURE__*/React.createElement("button", {
    style: s.btn(),
    onClick: newClient
  }, "+ Nouvelle"))), /*#__PURE__*/React.createElement("div", {
    style: {
      padding: "0 16px 80px"
    }
  }, visible.length === 0 && /*#__PURE__*/React.createElement("div", {
    style: {
      textAlign: "center",
      padding: 50,
      color: C.gray,
      fontStyle: "italic"
    }
  }, search ? "Aucun r√©sultat" : "Aucune cliente ‚Äî appuyez sur + Nouvelle"), visible.map(c => {
    const forfait = FORFAITS.find(f => f.id === c.forfait);
    const done = (c.sessions || []).filter(s => s.done).length;
    const total = (c.sessions || []).length;
    const pct = total > 0 ? Math.round(done / total * 100) : 0;
    return /*#__PURE__*/React.createElement("div", {
      key: c.id,
      onClick: () => {
        setSelected(c);
        setView("detail");
      },
      style: {
        ...s.card({
          cursor: "pointer",
          display: "flex",
          alignItems: "center",
          gap: 14
        })
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        width: 44,
        height: 44,
        borderRadius: "50%",
        background: C.mid,
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        color: "white",
        fontSize: 19,
        fontWeight: 700,
        flexShrink: 0
      }
    }, (c.prenom || "?")[0]), /*#__PURE__*/React.createElement("div", {
      style: {
        flex: 1,
        minWidth: 0
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        fontWeight: 600,
        fontSize: 15
      }
    }, c.prenom, " ", c.nom), /*#__PURE__*/React.createElement("div", {
      style: {
        fontSize: 12,
        color: C.gray
      }
    }, forfait?.label || "Pas de forfait", c.localisation ? ` ‚Ä¢ ${c.localisation}` : ""), total > 0 && /*#__PURE__*/React.createElement("div", {
      style: {
        marginTop: 6
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        display: "flex",
        justifyContent: "space-between",
        fontSize: 11,
        color: C.gray,
        marginBottom: 3
      }
    }, /*#__PURE__*/React.createElement("span", null, done, "/", total, " s\xE9ances"), /*#__PURE__*/React.createElement("span", null, pct, "%")), /*#__PURE__*/React.createElement("div", {
      style: {
        height: 4,
        background: C.ultra,
        borderRadius: 2,
        overflow: "hidden"
      }
    }, /*#__PURE__*/React.createElement("div", {
      style: {
        height: "100%",
        width: `${pct}%`,
        background: C.light
      }
    })))), /*#__PURE__*/React.createElement("span", {
      style: {
        color: C.border,
        fontSize: 20
      }
    }, "\u203A"));
  })));
}

      try {
        var container = document.getElementById('root');
        var root = ReactDOM.createRoot(container);
        root.render(React.createElement(App));
      } catch(e) {
        document.getElementById('error').style.display = 'block';
        document.getElementById('error').innerText = 'Erreur de d√©marrage: ' + e.message;
      }
    })();
  </script>
</body>
</html>